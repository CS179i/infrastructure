{
  "rules": {
    "users": {
      "$uid": {
        ".read": "auth.uid === $uid",
        ".write": "auth.uid === $uid",
        "name": {
          ".validate": "newData.isString()"
        },
        "events": {
          "$event": {
            ".validate": "root.child('events/' + $event).exists()",
            "responses": {
              ".validate": "newData.isNumber()"
            }
          }
        },
        "connections": {
          "$otherUser": {
            ".validate": "root.child('users/' + $otherUser).exists()",
            ".write": "auth.token.guest != true",
            ".read": "auth.token.guest != true"
          }
        },
        "managed_events": {
          ".validate": "root.child('events/' + newData.val()).exists()",
          ".write": "auth.token.manager === true"
        }
      }
    },
    "events": {
      "$event": {
        ".read": true,
        ".write": "auth.uid === newData.child('manager').val() && auth.token.manager === true",
        "manager": {
          ".validate": "root.child('users/' + newData.val()).exists()"
        },
        "expires": {
          ".validate": "newData.val() > now"
        },
        "questionnaire": {
          "$question": {
            "content": {
              ".validate": "newData.isString()"
            },
            "responses": {
              "$response":{
                ".validate": "newData.isString()"
              }
            }
          }
        },
        "users": {
          "$uid": {
            ".validate": "root.child('users/' + $uid).exists()",
            ".write": true
          }
        }
      }
    }
  }
}
